#!/usr/bin/env -S deno -q run --allow-env --allow-net --allow-read --unstable

import yargs from "https://deno.land/x/yargs@v17.5.1-deno/deno.ts";

// @ts-ignore error
const argv = yargs(Deno.args).argv;

switch (argv._.shift() || 'repl') {
  case 'preprocess': {
    (await import('./ff-preprocess.ts')).run(argv);
    break;
  }
  case 'compile': {
    (await import('./ff-compile.ts')).run(argv);
    break;
  }
  case 'execute': {
    (await import('./ff-execute.ts')).run(argv);
    break;
  }
  case 'run': {
    (await import('./ff-run.ts')).run(argv);
    break;
  }
  case 'repl': {
    const { run } = await import('./ff-repl.ts');
    await run(argv);
    break;
  }
  default:
    throw new Error('Unknown command');
}